# æ•°æ®åŒæ­¥é—®é¢˜æµ‹è¯•æŒ‡å—

## é—®é¢˜æè¿°
æ›´æ–°è´¦æˆ·åè·³è½¬åˆ°åˆ—è¡¨é¡µï¼Œæœ‰æ—¶ï¼ˆçº¦1/3æ¦‚ç‡ï¼‰æ˜¾ç¤ºçš„è¿˜æ˜¯æ—§æ•°æ®ã€‚

## é—®é¢˜åŸå› 
**ç«æ€æ¡ä»¶ï¼ˆRace Conditionï¼‰**ï¼š
- æ›´æ–°æ“ä½œå’Œé¡µé¢è·³è½¬å‡ ä¹åŒæ—¶å‘ç”Ÿ
- SWR ç¼“å­˜çš„ `dedupingInterval: 5000` å¯¼è‡´5ç§’å†…ä¸ä¼šé‡æ–°è¯·æ±‚
- å¦‚æœè·³è½¬æ—¶æ•°æ®åº“è¿˜æœªå®Œæˆæ›´æ–°ï¼Œä¼šç¼“å­˜æ—§æ•°æ®

## å®æ–½çš„ä¿®å¤æ–¹æ¡ˆ

### 1. å¼ºåˆ¶æ•°æ®åˆ·æ–°
åœ¨åˆ—è¡¨é¡µæ£€æµ‹åˆ°æˆåŠŸæ¶ˆæ¯æ—¶ï¼Œç«‹å³è°ƒç”¨ `mutate()` å¼ºåˆ¶åˆ·æ–°æ•°æ®ã€‚

### 2. æ—¶é—´æˆ³å‚æ•°
è·³è½¬URLæ·»åŠ æ—¶é—´æˆ³å‚æ•° `?t=${timestamp}`ï¼Œç¡®ä¿æ¯æ¬¡éƒ½æ˜¯æ–°çš„è¯·æ±‚ã€‚

### 3. ä»£ç ä¿®æ”¹ä½ç½®
- `/app/admin/claude-accounts/page.tsx`: æ·»åŠ  `mutate()` è°ƒç”¨
- `/app/admin/claude-accounts/[id]/edit/page.tsx`: æ·»åŠ æ—¶é—´æˆ³å‚æ•°
- `/app/admin/claude-accounts/new/page.tsx`: æ·»åŠ æ—¶é—´æˆ³å‚æ•°

## æµ‹è¯•æ­¥éª¤

### å‡†å¤‡å·¥ä½œ
1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š`npm run dev`
2. ç™»å½•ç®¡ç†åå°
3. è¿›å…¥ Claude Accounts é¡µé¢

### æµ‹è¯•åœºæ™¯

#### åœºæ™¯ 1: ç¼–è¾‘è´¦æˆ·åç§°
1. ç‚¹å‡»ä»»æ„è´¦æˆ·çš„ Edit æŒ‰é’®
2. ä¿®æ”¹ Account Name
3. ç‚¹å‡» Update Account
4. **éªŒè¯**ï¼šè·³è½¬åç«‹å³æ˜¾ç¤ºæ–°çš„è´¦æˆ·åç§°

#### åœºæ™¯ 2: ä¿®æ”¹ä½¿ç”¨é™åˆ¶
1. ç¼–è¾‘è´¦æˆ·
2. ä¿®æ”¹ Usage Limit æ•°å€¼
3. ç‚¹å‡» Update Account
4. **éªŒè¯**ï¼šåˆ—è¡¨é¡µæ˜¾ç¤ºæ›´æ–°åçš„æ•°å€¼

#### åœºæ™¯ 3: è¿ç»­å¤šæ¬¡æ›´æ–°
1. å¿«é€Ÿè¿ç»­æ›´æ–°åŒä¸€è´¦æˆ·3-5æ¬¡
2. æ¯æ¬¡ä¿®æ”¹ä¸åŒçš„å­—æ®µ
3. **éªŒè¯**ï¼šæ¯æ¬¡éƒ½æ˜¾ç¤ºæœ€æ–°æ•°æ®

#### åœºæ™¯ 4: åˆ›å»ºæ–°è´¦æˆ·
1. ç‚¹å‡» Add New Account
2. å¡«å†™è¡¨å•å¹¶æäº¤
3. **éªŒè¯**ï¼šåˆ—è¡¨é¡µç«‹å³æ˜¾ç¤ºæ–°è´¦æˆ·

### éªŒè¯è¦ç‚¹
- âœ… æˆåŠŸæ¶ˆæ¯æ˜¾ç¤ºæ­£ç¡®
- âœ… æ•°æ®ç«‹å³æ›´æ–°ï¼ˆæ— å»¶è¿Ÿï¼‰
- âœ… URLå‚æ•°è‡ªåŠ¨æ¸…ç†
- âœ… æ— é—ªçƒæˆ–åŠ è½½å»¶è¿Ÿ

## è°ƒè¯•æ–¹æ³•

### æµè§ˆå™¨æ§åˆ¶å°
```javascript
// æŸ¥çœ‹ç½‘ç»œè¯·æ±‚
// Network æ ‡ç­¾é¡µåº”è¯¥æ˜¾ç¤ºï¼š
// 1. PUT/POST è¯·æ±‚åˆ° API
// 2. è·³è½¬åç«‹å³æœ‰ GET è¯·æ±‚è·å–åˆ—è¡¨

// æ§åˆ¶å°æ—¥å¿—
// åº”è¯¥çœ‹åˆ°ï¼š
// "âœ… Account updated successfully"
// "ğŸ”„ Sending PUT request..."
```

### æ£€æŸ¥ SWR ç¼“å­˜
```javascript
// åœ¨æ§åˆ¶å°è¿è¡Œ
window.__SWR_DEVTOOLS_USE__ = true
```

## é¢„æœŸç»“æœ
- **ä¿®å¤å‰**ï¼šçº¦1/3æ¦‚ç‡æ˜¾ç¤ºæ—§æ•°æ®
- **ä¿®å¤å**ï¼š100%æ˜¾ç¤ºæœ€æ–°æ•°æ®

## å¤‡é€‰æ–¹æ¡ˆï¼ˆå¦‚ä»æœ‰é—®é¢˜ï¼‰

### æ–¹æ¡ˆ B: å»¶è¿Ÿè·³è½¬
```javascript
// ç­‰å¾…100msç¡®ä¿æ•°æ®åº“æ›´æ–°å®Œæˆ
setTimeout(() => {
  router.push(`/admin/claude-accounts?success=...`)
}, 100)
```

### æ–¹æ¡ˆ C: ä¹è§‚æ›´æ–°
ä½¿ç”¨ SWR çš„ä¹è§‚æ›´æ–°åŠŸèƒ½ï¼Œç«‹å³åœ¨UIæ˜¾ç¤ºæ–°æ•°æ®ã€‚

### æ–¹æ¡ˆ D: ç¦ç”¨ç¼“å­˜
ä¸´æ—¶å°† `dedupingInterval` è®¾ä¸º 0 æˆ–æ›´å°çš„å€¼ã€‚